#!/usr/bin/env bash
# a script to start my favorite terminal emulator

version=6
args=( )
foreground=false

usage () {
  echo "Usage: ${0##*/} [-xf] [-e args ...]"
  echo "       ${0##*/} -h"
  echo "       ${0##*/} -v"
}
terminal () {
  if "$foreground"; then
    alacritty "$@"
  else
    alacritty msg create-window "$@" \
      || exec alacritty "$@"
  fi
}

while getopts e:fhvx opt; do
  case $opt in
    h) usage; exit;;
    v) echo "term -- Version $version (wrapping alacritty)"; exit;;
    x) set -x;;
    e) args=(-e "$OPTARG" "${@:$OPTIND}"); shift $#;;
    f) foreground=true;;
    *) usage >&2; exit 2;;
  esac
done

terminal "${args[@]}"
